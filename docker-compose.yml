services:
  app:
    build: .
    container_name: barber-api
    environment:
      - WHATSAPP_VERIFY_TOKEN=
      - PORT=8080
    expose:
      - "8080"
    networks:
      - internal_net

  ngrok:
    image: ngrok/ngrok:latest
    container_name: ngrok
    command: http --domain=decent-happily-herring.ngrok-free.app app:8080
    environment:
      - NGROK_AUTHTOKEN=${NGROK_AUTH}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      - internal_net
    ports:
      - "4040:4040"

networks:
  internal_net:
    driver: bridge
